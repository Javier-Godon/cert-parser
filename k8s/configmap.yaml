apiVersion: v1
kind: ConfigMap
metadata:
  name: cert-parser-config
  namespace: default  # Change to your namespace
  labels:
    app: cert-parser
data:
  # ── OpenID Connect Configuration ────
  AUTH_URL: "https://keycloak.example.com/realms/app/protocol/openid-connect/token"
  AUTH_CLIENT_ID: "your-client-id"
  AUTH_USERNAME: "your-username"

  # ── SFC Login Configuration ─────────
  LOGIN_URL: "https://api.example.com/auth/v1/login"
  LOGIN_BORDER_POST_ID: "1"
  LOGIN_BOX_ID: "1"
  LOGIN_PASSENGER_CONTROL_TYPE: "1"

  # ── Certificate Download Configuration ────
  DOWNLOAD_URL: "https://api.example.com/certificates/csca"

  # ── HTTP Settings ───────────────────
  HTTP_TIMEOUT_SECONDS: "60"

  # ── Scheduler Configuration ──────────
  SCHEDULER_INTERVAL_HOURS: "6"
  RUN_ON_STARTUP: "false"  # In K8s, usually false (runs on schedule, not on startup)

  # ── Logging ──────────────────────────
  LOG_LEVEL: "INFO"  # Change to DEBUG for verbose logging

---

apiVersion: v1
kind: Secret
metadata:
  name: cert-parser-secrets
  namespace: default  # Change to your namespace
  labels:
    app: cert-parser
type: Opaque
stringData:
  # ── Sensitive Configuration (managed by Secrets, not ConfigMap) ────
  # These values are injected from external secrets management (Vault, sealed-secrets, etc.)
  
  # OpenID Connect client secret
  auth-client-secret: "changeme-client-secret"
  
  # OpenID Connect password
  auth-password: "changeme-password"
  
  # PostgreSQL connection string (example format)
  # Change to your actual database credentials
  database-dsn: "postgresql://cert_parser:changeme-password@postgres.example.com:5432/cert_parser_db"
